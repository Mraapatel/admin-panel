import{a as se}from"./chunk-F4ANZG5M.js";import{a as ce}from"./chunk-MWJ4WU3J.js";import{a as B}from"./chunk-LPHQSWWG.js";import{a as ae}from"./chunk-FFH4G4ZB.js";import{a as le}from"./chunk-E63PU5HU.js";import{b as G}from"./chunk-CQJPOHPZ.js";import{b as K,g as z,h as X,j as Y,m as Z,n as J,o as ee,p as te,q as ie,s as ne,u as re}from"./chunk-HEVKUVIP.js";import{h as oe,j as de}from"./chunk-62B6BSLF.js";import{$b as N,Ab as y,Db as R,E as _,Fb as u,Ib as W,Jb as O,Pb as V,Qa as D,Qb as i,Rb as S,Sb as m,Ta as a,Tb as I,Yb as L,Zb as j,_b as P,ac as A,ca as C,e as U,ha as $,hb as x,mb as E,o as p,pa as v,qa as g,qb as f,rb as F,tb as T,ub as k,uc as q,vb as n,wb as t,wc as H,xb as b,xc as Q}from"./chunk-5BOCFAQI.js";var M=(l,s)=>({"background-color":l,color:s}),me=l=>({"background-color":l});function ue(l,s){if(l&1&&(n(0,"option",45),i(1),t()),l&2){let r=s.$implicit;W("value",r._id),a(),m(" ",r.vehicleType," ")}}function he(l,s){if(l&1&&T(0,ue,2,2,"option",45,F),l&2){let r=u();k(r.fetchedVehicleTypes)}}function pe(l,s){l&1&&i(0," Assigning ")}function _e(l,s){l&1&&i(0," Arrived ")}function fe(l,s){l&1&&i(0," Picked ")}function xe(l,s){l&1&&i(0," Started ")}function Se(l,s){l&1&&i(0," Accepted ")}function ve(l,s){l&1&&i(0," hold ")}function ge(l,s){l&1&&i(0," pending ")}function Re(l,s){if(l&1&&(n(0,"div",50),i(1),t()),l&2){let r=u().$implicit;E("ngStyle",P(2,M,r.rideStatus===0?"lightblue":r.rideStatus===1?"orange":r.rideStatus===5||r.rideStatus===3||r.rideStatus===4||r.rideStatus===2?"green":"sky",r.rideStatus===5||r.rideStatus===3||r.rideStatus===4||r.rideStatus===2?"white":"black")),a(),m(" ",r.driverId==null?null:r.driverId.driverName," ")}}function Ce(l,s){l&1&&i(0," Reassign ")}function be(l,s){l&1&&i(0," Assign ")}function Ee(l,s){if(l&1){let r=y();n(0,"button",53),R("click",function(){v(r);let d=u().$implicit,o=u(2);return g(o.AssingBtnClicked(d))}),x(1,Ce,1,0)(2,be,1,0),t()}if(l&2){let r=u().$implicit;E("ngStyle",j(2,me,r.rideStatus===0?"lightblue":r.rideStatus===1?"orange":r.rideStatus===2?"green":r.rideStatus===6?"transperent":"lightblue")),a(),f(1,r.rideStatus===9?1:2)}}function Ie(l,s){l&1&&i(0," Picked ")}function ye(l,s){l&1&&i(0," Completed ")}function Fe(l,s){l&1&&i(0," Arrived ")}function Te(l,s){l&1&&i(0," Start ")}function ke(l,s){if(l&1){let r=y();n(0,"button",55),R("click",function(){v(r);let d=u(2).$implicit,o=u(2);return g(o.ActionBtn(d.rideStatus,d._id,d.driverId==null?null:d.driverId._id))}),x(1,Ie,1,0)(2,ye,1,0)(3,Fe,1,0)(4,Te,1,0),t()}if(l&2){let r,e=u(2).$implicit;E("ngStyle",P(2,M,e.rideStatus===0?"lightblue":e.rideStatus===1?"yellow":e.rideStatus===5?"green":e.rideStatus===6?"blue":e.rideStatus===3?"purple":e.rideStatus===4?"lightgreen":e.rideStatus===2?"green":"sky",e.rideStatus===5||e.rideStatus===2||e.rideStatus===3?"white":"black")),a(),f(1,(r=e.rideStatus)===2?1:r===3?2:r===4?3:r===5?4:-1)}}function we(l,s){if(l&1&&x(0,ke,5,5,"button",54),l&2){let r=u().$implicit;f(0,r.rideStatus!==1&&r.rideStatus!==6&&r.rideStatus!==9?0:-1)}}function Ne(l,s){if(l&1){let r=y();n(0,"button",56),R("click",function(){v(r);let d=u().$implicit,o=u(2);return g(o.cancleTheRide(d._id,d.driverId==null?null:d.driverId._id))}),i(1," Cancle "),t()}}function Ae(l,s){if(l&1){let r=y();n(0,"tr",46)(1,"td",47),i(2),t(),n(3,"td",48),i(4),t(),n(5,"td",48),i(6),t(),n(7,"td",49),i(8),t(),n(9,"td",49),i(10),t(),n(11,"td",48),i(12),t(),n(13,"td",48)(14,"button",50),x(15,pe,1,0)(16,_e,1,0)(17,fe,1,0)(18,xe,1,0)(19,Se,1,0)(20,ve,1,0)(21,ge,1,0),t()(),n(22,"td",48),x(23,Re,2,5,"div",50)(24,Ee,3,4),t(),n(25,"td",48)(26,"button",51),R("click",function(){let d=v(r).$implicit,o=u(2);return g(o.rideInfo(d))}),n(27,"b"),i(28,"i"),t()(),x(29,we,1,1)(30,Ne,2,0,"button",52),t()(),b(31,"br")}if(l&2){let r,e=s.$implicit;a(2),S(e.Ride_index),a(2),S(e.date),a(2),S(e.userId.userName),a(2),S(e.startLocation),a(2),S(e.endLocation),a(2),S(e.typeId.vehicleType),a(2),E("ngStyle",P(11,M,e.rideStatus===0?"lightblue":e.rideStatus===1?"yellow":e.rideStatus===5?"green":e.rideStatus===6?"blue":e.rideStatus===3?"purple":e.rideStatus===4?"lightgreen":e.rideStatus===2?"violet":"lightblue",e.rideStatus===5||e.rideStatus===3?"white":"black")),a(),f(15,(r=e.rideStatus)===1?15:r===2?16:r===3?17:r===4?18:r===5?19:r===6?20:21),a(8),f(23,e.driverId!=null&&e.driverId.driverName?23:24),a(6),f(29,e.rideStatus!==0?29:-1),a(),f(30,e.rideStatus===1||e.rideStatus===0||e.rideStatus===6||e.rideStatus===9?30:-1)}}function Pe(l,s){if(l&1&&T(0,Ae,32,14,null,null,F),l&2){let r=u();k(r.RidesFetched)}}function De(l,s){l&1&&(n(0,"div",27)(1,"h3"),i(2,"No Rides Found"),t()())}function Oe(l,s){if(l&1){let r=y();n(0,"tr",36)(1,"td"),b(2,"img",57),t(),n(3,"td"),i(4),t(),n(5,"td"),i(6),t(),n(7,"td"),i(8),t(),n(9,"td"),i(10),t(),n(11,"td"),i(12),t(),n(13,"td")(14,"button",58),R("click",function(){let d=v(r).$implicit,o=u();return g(o.AssignDriverToRide(d))}),i(15," Assign "),t()()()}if(l&2){let r=s.$implicit,e=u();a(2),O("alt","",r.driverName," Icon"),E("src",e.backendUrl+"public/driverProfile/"+r.driverProfile,D),a(2),S(r.driverName),a(2),S(r.driverEmail),a(2),I("",e.selectedRide.countryInfo.countryCallingCode," ",r.driverPhone,""),a(2),S(e.selectedRide.typeId.vehicleType),a(2),S(e.ActiveDrivers[0].cityId.formatted_address)}}function Ve(l,s){l&1&&(n(0,"div",59)(1,"h3",60),i(2,"No Available Driver Found"),t()(),b(3,"hr"))}function Be(l,s){if(l&1&&(n(0,"td",61),i(1),t()),l&2){let r=s.$implicit,e=s.$index;a(),I(":",e+1,"-",r,"")}}function Me(l,s){l&1&&(n(0,"td"),i(1,": No Way Points for this Ride"),t())}function Ue(l,s){if(l&1&&(n(0,"table",38)(1,"tr")(2,"th"),i(3,"Request-id"),t(),n(4,"td"),i(5),t()(),n(6,"tr")(7,"th"),i(8,"User-id: "),t(),n(9,"td"),i(10),t()(),n(11,"tr")(12,"th"),i(13,"User Name "),t(),n(14,"td"),i(15),t()(),n(16,"tr")(17,"th"),i(18,"User Phone"),t(),n(19,"td"),i(20),t()(),n(21,"tr")(22,"th"),i(23,"User Email "),t(),n(24,"td"),i(25),t()(),n(26,"tr")(27,"th"),i(28,"PickUp Location "),t(),n(29,"td"),i(30),t()(),n(31,"tr")(32,"th"),i(33,"Drop-Off Location "),t(),n(34,"td"),i(35),t()(),n(36,"tr")(37,"th"),i(38,"Way Points: "),t(),T(39,Be,2,2,"td",61,F),x(41,Me,2,0,"td"),t(),n(42,"tr")(43,"th"),i(44,"Service Type "),t(),n(45,"td"),i(46),t()(),n(47,"tr")(48,"th"),i(49,"Total Distance "),t(),n(50,"td"),i(51),N(52,"number"),t()(),n(53,"tr")(54,"th"),i(55,"Estimated Time "),t(),n(56,"td"),i(57),t()(),n(58,"tr")(59,"th"),i(60,"Estimated Fare "),t(),n(61,"td"),i(62),N(63,"number"),t()()()),l&2){let r=u();a(5),m(": ",r.selectedRide._id,""),a(5),m(": ",r.selectedRide.userId._id,""),a(5),m(": ",r.selectedRide.userId.userName,""),a(5),I(" : ",r.selectedRide.countryInfo.countryCallingCode," ",r.selectedRide.userId.userPhone,""),a(5),m(": ",r.selectedRide.userId.userEmail,""),a(5),m(": ",r.selectedRide.startLocation,""),a(5),m(": ",r.selectedRide.endLocation,""),a(4),k(r.selectedRide.route),a(2),f(41,r.selectedRide.route&&r.selectedRide.route.length==0?41:-1),a(5),m(": ",r.selectedRide.typeId.vehicleType,""),a(5),m(": ",A(52,14,r.selectedRide.totalDistance,"1.2-2")," Km"),a(6),m(" : ",r.selectedRide.totalTime," m "),a(5),I(" : ",A(63,17,r.selectedRide.totalFare,"1.2-2")," ",r.selectedRide.countryInfo.currency,"")}}function $e(l,s){if(l&1&&(n(0,"td",61),i(1),t()),l&2){let r=s.$implicit,e=s.$index;a(),I(":",e+1,"-",r,"")}}function We(l,s){l&1&&(n(0,"td"),i(1,": No Way Points for this Ride"),t())}function Le(l,s){if(l&1&&(n(0,"div",62),b(1,"img",63),t(),n(2,"div",37)(3,"table",38),b(4,"tr",64),n(5,"tr")(6,"th"),i(7,"User Name "),t(),n(8,"td"),i(9),t()(),n(10,"tr")(11,"th"),i(12,"User Phone"),t(),n(13,"td"),i(14),t()(),n(15,"tr")(16,"th"),i(17,"User Email "),t(),n(18,"td"),i(19),t()(),n(20,"tr")(21,"th"),i(22,"Book Date"),t(),n(23,"td"),i(24),t()(),n(25,"tr")(26,"th"),i(27,"Book Time"),t(),n(28,"td"),i(29),t()(),n(30,"tr")(31,"th"),i(32,"PickUp Location "),t(),n(33,"td"),i(34),t()(),n(35,"tr")(36,"th"),i(37,"Drop-Off Location "),t(),n(38,"td"),i(39),t()(),n(40,"tr")(41,"th"),i(42,"Way Points: "),t(),T(43,$e,2,2,"td",61,F),x(45,We,2,0,"td"),t(),n(46,"tr")(47,"th"),i(48,"Service Type "),t(),n(49,"td"),i(50),t()(),n(51,"tr")(52,"th"),i(53,"Total Distance "),t(),n(54,"td"),i(55),N(56,"number"),t()(),n(57,"tr")(58,"th"),i(59,"Estimated Time "),t(),n(60,"td"),i(61),t()(),n(62,"tr")(63,"th"),i(64,"Estimated Fare "),t(),n(65,"td"),i(66),N(67,"number"),t()()()()),l&2){let r=u();a(),O("alt","",r.rideInfoOfSelectedRide.userId.userName," Icon"),E("src",r.backendUrl+"public/userProfile/"+r.rideInfoOfSelectedRide.userId.userProfile,D),a(8),m(": ",r.rideInfoOfSelectedRide.userId.userName,""),a(5),I(" : ",r.rideInfoOfSelectedRide.countryInfo.countryCallingCode," ",r.rideInfoOfSelectedRide.userId.userPhone,""),a(5),m(": ",r.rideInfoOfSelectedRide.userId.userEmail,""),a(5),m(": ",r.rideInfoOfSelectedRide.date,""),a(5),m(": ",r.rideInfoOfSelectedRide.timeInString,""),a(5),m(": ",r.rideInfoOfSelectedRide.startLocation,""),a(5),m(": ",r.rideInfoOfSelectedRide.endLocation,""),a(4),k(r.rideInfoOfSelectedRide.route),a(2),f(45,r.rideInfoOfSelectedRide.route&&r.rideInfoOfSelectedRide.route.length==0?45:-1),a(5),m(": ",r.rideInfoOfSelectedRide.typeId.vehicleType,""),a(5),m(": ",A(56,17,r.rideInfoOfSelectedRide.totalDistance,"1.2-2")," Km"),a(6),m(" : ",r.rideInfoOfSelectedRide.totalTime," m "),a(5),I(" : ",A(67,20,r.rideInfoOfSelectedRide.totalFare,"1.2-2")," ",r.rideInfoOfSelectedRide.countryInfo.currency,"")}}var ot=(()=>{let s=class s{constructor(){this._socketIoService=C(ae),this._fb=C(ne),this._confirmRideService=C(B),this._toster=C(oe),this._runningRequestService=C(ce),this._confirmRiedService=C(B),this._browserNotification=C(le),this._router=C(G),this.backendUrl=de.BACKEND_URL,this.pageNumber=1,this.limit=3,this.searchTerm="",this.fetchedVehicleTypes=[],this.ActiveDrivers=[]}ngOnInit(){this._runningRequestService.listenToIncomingRides().subscribe({next:d=>{this.returnedRideInfo=d;let o=this.RidesFetched.findIndex(c=>c._id===this.returnedRideInfo._id);this.RidesFetched[o]=this.returnedRideInfo,console.log("this.RidesFetched[index]",this.RidesFetched[o])}}),this._socketIoService.listen("acceptedRideWithDriver").pipe(_(d=>(this._toster.error("Error getting the acceptedRideWithDriver","Error"),p(d)))).subscribe({next:d=>{let o=this.RidesFetched.findIndex(c=>c._id===d._id);console.log(d),this.RidesFetched[o].rideStatus=d.rideStatus}}),this.confirmRideForm=this._fb.group({searchTerm:[""],rideStatus:[""],vechicleType:[""],date:[""]});let e={limit:this.limit,page:this.pageNumber,rideStatus:parseInt(this.confirmRideForm.get("rideStatus")?.value),date:this.confirmRideForm.get("date")?.value,searchTerm:"",vechicleType:this.confirmRideForm.get("vechicleType")?.value};this.fetchRides(e),this.fetcheTypes(),this.listningToRejectedRide(),this.listningToCronFormManullyAssignedRides(),this.listningToCron(),this.loadStripe()}loadStripe(){return U(this,null,function*(){if(!this.STRIPE)try{this.STRIPE=yield se("pk_test_51PKFbURvggPBSsNZHM7EzVRAd0C41qQyAhsHDMyp8XxUdjXkZhjsLrkQN0YREobqcQfQOyQmuuIBHO94EHd2TGpc00kWQ3qOBF")}catch(e){console.error("Error loading Stripe SDK:",e)}return this.STRIPE})}AssingBtnClicked(e){this.selectedRide=e,this.RidesUser=e.userId;let d={cityId:this.selectedRide.cityId,typeId:this.selectedRide.typeId._id,rideStatus:0};this._confirmRiedService.getDriverForAssignRide(d).pipe(_(o=>(this._toster.error("Error fetching the active drivers","Error"),p(o)))).subscribe({next:o=>{this.ActiveDrivers=o.driverArray,console.log(o)}})}notify(e){let d={title:"Running Requests",alertContent:`Driver Not Found! - for ${e}`};this._browserNotification.generateNotification(d)}rideInfo(e){this.rideInfoOfSelectedRide=e,console.log("this.rideInfoOfSelectedRide",this.rideInfoOfSelectedRide)}cancleTheRide(e,d){if(!confirm("Are you sure , You want to delete this Ride ?"))return;let o;d?o={rideId:e,driverId:d}:o={rideId:e,driverId:d},this._confirmRideService.cancleRide(o).pipe(_(c=>(console.log("error in catchError",c),this._toster.error("Some Error Occured While cancling the ride","Error"),p(c)))).subscribe({next:c=>{console.log("res in next",c),this._toster.success("Ride Cancled Successfully","Success"),console.log("r._id",this.RidesFetched[0]._id),console.log("res.rideId",c.rideId);let h=this.RidesFetched.findIndex(w=>w._id===c.rideId);console.log("r"),h!==-1&&(console.log("index",h),console.log("this.ridesfetched",this.RidesFetched[h]),this.RidesFetched.splice(h,1))}})}rideStarted(e,d){this._confirmRideService.rideStarted(e,d).pipe(_(o=>(console.log("error in catchError",o),this._toster.error("Some Error Occured While starting the ride","Error"),p(o)))).subscribe({next:o=>{console.log("res in next",o),this._toster.success("Ride started Successfully","Success"),console.log("r._id",this.RidesFetched[0]._id),console.log("res.rideId",o.rideId);let c=this.RidesFetched.findIndex(h=>h._id==o.rideId);this.RidesFetched[c].rideStatus=o.rideStatus,console.log("index",c)}})}rideArrived(e,d){this._confirmRideService.rideArrived(e,d).pipe(_(o=>(console.log("error in catchError",o),this._toster.error("Some Error Occured While Changing Arrived Status of ride","Error"),p(o)))).subscribe({next:o=>{console.log("res in next",o),this._toster.success("Driver Arrived Successfully","Success");let c=this.RidesFetched.findIndex(h=>h._id==o.rideId);this.RidesFetched[c].rideStatus=o.rideStatus}})}ridePicked(e,d){this._confirmRideService.ridePicked(e,d).pipe(_(o=>(console.log("error in catchError",o),this._toster.error("Some Error Occured While Changing Pick Status of ride","Error"),p(o)))).subscribe({next:o=>{console.log("res in next",o),this._toster.success("user Picked Successfully","Success");let c=this.RidesFetched.findIndex(h=>h._id==o.rideId);this.RidesFetched[c].rideStatus=o.rideStatus}})}rideCompleted(e,d){this._confirmRideService.rideCompleted(e,d).pipe(_(o=>(console.log("error in catchError",o),this._toster.error("Some Error Occured While seting RideCompleted the ride","Error"),p(o)))).subscribe({next:o=>{if(console.log("res in next",o),o.status==201)this._toster.info("Please complete the Payment by clicking Complete ","Success"),window.location.replace(o.userPayment);else{this._toster.success(o.userPayment,"Success"),this._toster.success(o.driverPayment,"Success");let c=this.RidesFetched.findIndex(h=>h._id==o.rideId);this.RidesFetched.splice(c,1),this._router.navigate(["home/rideHistory"])}}})}ActionBtn(e,d,o){e===5?this.rideStarted(d,o):e===4?this.rideArrived(d,o):e===2?this.ridePicked(d,o):e===3&&this.rideCompleted(d,o)}listningToCron(){this._socketIoService.listen("updateListFromCron").pipe(_(e=>(this._toster.error("Error getting the rides form cron","Error"),p(e)))).subscribe({next:e=>{let d=this.RidesFetched.findIndex(o=>o._id===e._id);console.log("index",d),d!==-1&&(this.RidesFetched[d].driverId=e.driverId,this.RidesFetched[d].rideStatus=e.rideStatus,console.log("inside the updateListFromCron ",e))}}),this._socketIoService.listen("NoDriverRemaining-ByCron").pipe(_(e=>(this._toster.error("Error getting the rides form cron","Error"),p(e)))).subscribe({next:e=>{let d=this.RidesFetched.findIndex(o=>o._id==e.rideId);console.log("index",d),d!==-1&&(console.warn("NoDriverRemaining-ByCron",e.rideId),this.RidesFetched[d].rideStatus=e.rideStatus,console.log("notify",this.RidesFetched[d].userId.userName),this.notify(this.RidesFetched[d].userId.userName),this.RidesFetched[d].driverId=null,this._socketIoService.emitNewEvent("updateCount",{})),console.log(e)}}),this._socketIoService.listen("PutRideOnHold-FromCron").pipe(_(e=>(this._toster.error("Error getting the rides form cron","Error"),p(e)))).subscribe({next:e=>{let d=this.RidesFetched.findIndex(o=>o._id==e.rideId);console.log("index of ride matchd ",d),d!==-1&&(this.RidesFetched[d].rideStatus=e.rideStatus,this.RidesFetched[d].driverId=null),console.log(e)}})}listningToCronFormManullyAssignedRides(){this._socketIoService.listen("TimesUpForAssigndRides").pipe(_(e=>(this._toster.error("Error getting the rides form cron","Error"),p(e)))).subscribe({next:e=>{this.RidesFetched.forEach((d,o)=>{e.includes(d._id)&&(this.RidesFetched[o].driverId=null,this.RidesFetched[o].rideStatus=9,this.notify(this.RidesFetched[o].userId.userName))}),this._socketIoService.emitNewEvent("updateCount",{}),console.log(e)}})}assignAnyAvailableDriver(e){this._confirmRideService.assignNearestDriver(e).pipe(_(d=>(this._toster.error("Error occured while Assigning drivers","Error"),p(d)))).subscribe({next:d=>{console.log(d);let o=this.RidesFetched.findIndex(c=>c._id===this.selectedRide._id);this.RidesFetched[o].nearest=!0,this.selectedRide.nearest=!0}})}AssignDriverToRide(e){this.selectedDriver=e,console.log("selectedDriver",this.selectedDriver.driverName);let d={rideId:this.selectedRide._id,driverId:e._id,rideStatus:1};this._confirmRideService.assignDriverToRide(d).subscribe({error:o=>{o.error.message==="faild to assign driver"&&this._toster.error("No Ride found","Error"),this._toster.error("Error Occured while ")}})}listningToRejectedRide(){this._socketIoService.listen("rejectedRideByDriver").pipe(_(e=>(this._toster.error("Error getting the acceptedRideWithDriver","Error"),p(e)))).subscribe({next:e=>{let d=this.RidesFetched.findIndex(o=>o._id===e._id);this.RidesFetched[d].driverId=null,this.RidesFetched[d].rideStatus=e.rideStatus,console.log(e)}})}fetcheTypes(){this._confirmRideService.getVehicleTypes().pipe(_(e=>(this._toster.error("Error while fetching the vehicle types","Error"),p(e)))).subscribe({next:e=>{this.fetchedVehicleTypes=e.TypesArray,console.log(this.fetchedVehicleTypes)}})}previousBtn(){if(this.disablePrevBnt()){this._toster.warning("Can't perform this action ","Warning");return}this.pageNumber=this.pageNumber>1?--this.pageNumber:1,console.log(this.pageNumber);let e={limit:this.limit,rideStatus:parseInt(this.confirmRideForm.get("rideStatus")?.value),page:this.pageNumber,date:this.confirmRideForm.get("date")?.value,searchTerm:this.confirmRideForm.get("searchTerm")?.value,vechicleType:this.confirmRideForm.get("vechicleType")?.value};this.fetchRides(e)}nextBtn(){if(this.disableNextBnt()){this._toster.warning("Can't perform this action ","Warning");return}this.pageNumber=++this.pageNumber,console.log(this.pageNumber);let e={limit:this.limit,rideStatus:parseInt(this.confirmRideForm.get("rideStatus")?.value),page:this.pageNumber,date:this.confirmRideForm.get("date")?.value,searchTerm:this.confirmRideForm.get("searchTerm")?.value,vechicleType:this.confirmRideForm.get("vechicleType")?.value};this.fetchRides(e)}fetchRides(e){this._confirmRideService.getRides(e).pipe(_(d=>(this._toster.error("Error while fetching the Rides","Error"),p(d)))).subscribe({next:d=>{this.RidesFetched=d.Rides,this.totalRides=d.totalRides,console.log("totalRide",this.totalRides),console.log(this.RidesFetched),console.log(d),d.Rides.length>0?this._toster.success("Ride Fetched Successfully","Success"):this._toster.warning("No Rides Found","Warning")}})}searchRides(e){let d=this.confirmRideForm.value;if(console.log("dateeeee",this.confirmRideForm.get("date")?.value),!Object.values(d).some(c=>c!=="")){this._toster.info("There is nothing to Apply","Info");return}let o={limit:this.limit,rideStatus:parseInt(this.confirmRideForm.get("rideStatus")?.value),page:this.pageNumber,date:this.confirmRideForm.get("date")?.value,searchTerm:this.confirmRideForm.get("searchTerm")?.value,vechicleType:this.confirmRideForm.get("vechicleType")?.value};this.fetchRides(o)}ClearFilter(){let e=this.confirmRideForm.value;if(!Object.values(e).some(o=>o!=="")){this._toster.info("There is nothing to clear","Info");return}this.confirmRideForm.reset();let d={limit:this.limit,rideStatus:parseInt(this.confirmRideForm.get("rideStatus")?.value),page:this.pageNumber,date:this.confirmRideForm.get("date")?.value,searchTerm:this.confirmRideForm.get("searchTerm")?.value,vechicleType:this.confirmRideForm.get("vechicleType")?.value};this.fetchRides(d)}disablePrevBnt(){return this.pageNumber==1?!0:this.pageNumber==0}disableNextBnt(){if(this.totalRides==this.pageNumber*this.limit)return!0;if(this.totalRides<this.pageNumber*this.limit)return!0;if(this.RidesFetched){if(this.RidesFetched.length<0)return!0}else if(this.pageNumber==0)return!0;return!1}};s.\u0275fac=function(d){return new(d||s)},s.\u0275cmp=$({type:s,selectors:[["app-confirm-ride"]],standalone:!0,features:[L],decls:108,vars:7,consts:[["inputValue",""],[3,"formGroup"],[1,"input-group","my-3"],["for","vechicleType",1,"mt-1"],["name","vechicleType","id","","formControlName","vechicleType",1,"ms-1","form-select","me-3","rounded"],["type","date","placeholder","please select the date","formControlName","date",1,"form-control","rounded"],[1,"input-group-append"],[1,"input-group-text","bg-dark","text-white"],[1,"input-group","mb-2"],["for","rideStatus",1,"mt-1","me-1"],["name","rideStatus","formControlName","rideStatus",1,"form-select","me-3","ms-2","rounded"],["value","0"],["value","1"],["value","5"],["value","2"],["value","3"],["value","4"],["type","text","name","searchTerm","placeholder"," search by username, phone number, RideId,etc....","formControlName","searchTerm",1,"form-control","rounded",3,"keyup.enter"],[1,"input-group-text","bg-dark","text-white","ps-3"],[1,"btn","btn-success","text-white","btn-sm","my-2",3,"click"],[1,"ms-2","btn","btn-warning","text-white","btn-sm","my-2",3,"click"],[1,"table-responsive","rounded"],[1,"container","text-center","h2"],[1,"table","table-responsive","overflow-auto"],[1,"border","text-center","p-1","py-2","bg-dark","text-white","id"],[1,"border","text-center","p-1","py-2","bg-dark","text-white"],[1,"border","text-center","p-1","py-2","bg-dark","text-white","width"],[1,"container","text-danger","d-flex","justify-content-center"],["id","AssignModal",1,"modaldiv","modal","fade"],[1,"modal-dialog","modal-xl"],[1,"modal-content"],[1,"modal-header","text-center"],[1,"modal-title"],["type","button","data-bs-dismiss","modal",1,"btn-close"],[1,"container","table-responsive"],[1,"table"],[1,"border-bottom"],[1,"container","table-responsive","d-flex","justify-content-start"],["id","InfoTable",1,"ms-3"],[1,"modal-footer"],["data-bs-dismiss","modal",1,"btn","btn-danger","shadow"],["data-bs-dismiss","modal",1,"btn","btn-success","shadow",3,"click"],["id","infoModal",1,"modaldiv","modal","fade"],[1,"modal-dialog","modal-lg"],["data-bs-dismiss","modal",1,"btn","btn-secondary","shadow"],[3,"value"],[1,"hover","rounded","shadow"],[1,"border","text-center","p-1","py-2","id"],[1,"border","text-center","p-1","py-2"],[1,"border","text-center","p-1","py-2","width"],[1,"btn",3,"ngStyle"],["data-bs-toggle","modal","data-bs-target","#infoModal",1,"btn","btn-secondary","btn-sm","mx-2","mb-2","mt-2",3,"click"],[1,"btn","btn-danger"],["data-bs-toggle","modal","data-bs-target","#AssignModal",1,"btn","btn-info",3,"click","ngStyle"],[1,"btn","mb-2","mt-1","me-2",3,"ngStyle"],[1,"btn","mb-2","mt-1","me-2",3,"click","ngStyle"],[1,"btn","btn-danger",3,"click"],["onerror","this.src='assets/noImageFound.jpg'",1,"my-1","border","profile","rounded","img-fluid",3,"src","alt"],["data-bs-dismiss","modal",1,"btn","btn-info",3,"click"],[1,"container","d-flex","justify-content-center"],[1,"text-danger"],[1,"space"],[1,"text-center","my-1"],["onerror","this.src='assets/noImageFound.jpg'",1,"my-1","border","profile2","rounded","img-fluid",3,"src","alt"],[1,"text-center"]],template:function(d,o){if(d&1){let c=y();n(0,"div")(1,"form",1)(2,"div",2)(3,"label",3),i(4,"Vehicle Type :"),t(),n(5,"select",4),x(6,he,2,0),t(),b(7,"input",5),n(8,"div",6)(9,"div",7),i(10,"Select Date"),t()()(),n(11,"div",8)(12,"label",9),i(13,"Ride Status :"),t(),n(14,"select",10)(15,"option",11),i(16,"Pending"),t(),n(17,"option",12),i(18,"Assigning"),t(),n(19,"option",13),i(20,"Accepted"),t(),n(21,"option",14),i(22,"Arrived"),t(),n(23,"option",15),i(24,"Picked"),t(),n(25,"option",16),i(26,"Started"),t(),n(27,"option",14),i(28,"Confirmed"),t()(),n(29,"input",17,0),R("keyup.enter",function(){v(c);let w=V(30);return g(o.searchRides(w.value))}),t(),n(31,"div",6)(32,"div",18),i(33,"Apply filter"),t()()(),n(34,"button",19),R("click",function(){v(c);let w=V(30);return g(o.searchRides(w.value))}),i(35,"Apply Filter"),t(),n(36,"button",20),R("click",function(){return v(c),g(o.ClearFilter())}),i(37,"clear Filter"),t()(),n(38,"div",21)(39,"div",22),i(40," Confirm Ride "),t(),n(41,"table",23)(42,"tr")(43,"th",24),i(44,"Ride Id"),t(),n(45,"th",25),i(46,"Pick Up Time"),t(),n(47,"th",25),i(48,"User Name"),t(),n(49,"th",26),i(50,"Pick up address"),t(),n(51,"th",25),i(52,"Drop off address"),t(),n(53,"th",25),i(54,"Service Type"),t(),n(55,"th",25),i(56,"Status"),t(),n(57,"th",25),i(58,"Assign"),t(),n(59,"th",25),i(60,"Action"),t()(),x(61,Pe,2,0),t(),x(62,De,3,0,"div",27),t()(),n(63,"div",28)(64,"div",29)(65,"div",30)(66,"div",31)(67,"h4",32),i(68,"Active Drivers "),t(),b(69,"button",33),t(),n(70,"div",34)(71,"table",35)(72,"tr")(73,"th"),i(74,"Driver Profile"),t(),n(75,"th"),i(76,"Driver Name"),t(),n(77,"th"),i(78,"Driver Email"),t(),n(79,"th"),i(80,"Driver Phone"),t(),n(81,"th"),i(82,"Driver service Type"),t(),n(83,"th"),i(84,"City"),t(),n(85,"th"),i(86,"Action"),t()(),T(87,Oe,16,9,"tr",36,F),t(),x(89,Ve,4,0),t(),n(90,"div",37),x(91,Ue,64,20,"table",38),t(),n(92,"div",39)(93,"button",40),i(94,"Cancle"),t(),n(95,"button",41),R("click",function(){return v(c),g(o.assignAnyAvailableDriver(o.selectedRide._id))}),i(96,"Assign Any Available Driver"),t()()()()(),n(97,"div",42)(98,"div",43)(99,"div",30)(100,"div",31)(101,"h4",32),i(102,"Ride Information"),t(),b(103,"button",33),t(),x(104,Le,68,23),n(105,"div",39)(106,"button",44),i(107,"Close"),t()()()()()}d&2&&(a(),E("formGroup",o.confirmRideForm),a(5),f(6,o.fetchedVehicleTypes?6:-1),a(55),f(61,o.RidesFetched?61:-1),a(),f(62,o.RidesFetched&&o.RidesFetched.length==0?62:-1),a(25),k(o.ActiveDrivers),a(2),f(89,o.ActiveDrivers&&o.ActiveDrivers.length==0?89:-1),a(2),f(91,o.selectedRide?91:-1),a(13),f(104,o.rideInfoOfSelectedRide?104:-1))},dependencies:[re,Y,te,ie,K,ee,z,X,Z,J,Q,q,H],styles:[".profile[_ngcontent-%COMP%]{height:60px;width:60px;border-radius:5px}.profile2[_ngcontent-%COMP%]{height:80px;width:80px;border-radius:5px}#InfoTable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-left:3rem}#InfoTable[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid silver}.width[_ngcontent-%COMP%]{max-width:10rem}.id[_ngcontent-%COMP%]{max-width:13rem}"]});let l=s;return l})();export{ot as ConfirmRideComponent};
